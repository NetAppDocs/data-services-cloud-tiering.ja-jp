---
sidebar: sidebar 
permalink: task-managing-object-storage.html 
keywords: object storage, mirror object storage, create object storage, remove object storage, swap object storage, display object storage, license 
summary: オンプレミスのONTAPクラスターを特定のオブジェクト ストレージにデータを階層化するように構成したら、 NetApp Cloud Tieringで追加のオブジェクト ストレージ タスクを実行できます。新しいオブジェクト ストレージを追加したり、階層化されたデータをセカンダリ オブジェクト ストレージにミラーリングしたり、プライマリ オブジェクト ストレージとミラー オブジェクト ストレージを交換したり、ミラー化されたオブジェクト ストアをアグリゲートから削除したりすることができます。 
---
= NetApp Cloud Tieringでデータ階層化に使用されるオブジェクト ストレージを管理する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
オンプレミスのONTAPクラスターを特定のオブジェクト ストレージにデータを階層化するように構成したら、 NetApp Cloud Tieringを使用して追加のオブジェクト ストレージ タスクを実行できます。新しいオブジェクト ストレージを追加したり、階層化されたデータをセカンダリ オブジェクト ストレージにミラーリングしたり、プライマリ オブジェクト ストレージとミラー オブジェクト ストレージを交換したり、ミラー化されたオブジェクト ストアをアグリゲートから削除したりすることができます。



== クラスターに構成されたオブジェクト ストアを表示する

各クラスターに対して構成されているすべてのオブジェクト ストアと、それらが接続されているアグリゲートを表示できます。

.手順
. *クラスター* ページから、クラスターのメニュー アイコンを選択し、*オブジェクト ストア情報* を選択します。
. *クラスター* ページから、クラスターのメニュー アイコンを選択し、*オブジェクト ストア情報* を選択します。
. オブジェクト ストアの詳細を確認します。
+
この例では、クラスター上の異なるアグリゲートに接続された Amazon S3 と Azure Blob オブジェクト ストアの両方を示します。

+
image:screenshot_tiering_object_store_view.png["オブジェクト ストレージ情報を示すスクリーンショット。使用済み容量の合計、オブジェクト ストアにアタッチされた集計、オブジェクト ストアの名前などの詳細情報が表示されます。"]





== 新しいオブジェクトストアを追加する

クラスター内の集約用の新しいオブジェクト ストアを追加できます。作成したら、アグリゲートに添付できます。

.手順
. *クラスター* ページから、クラスターのメニュー アイコンを選択し、*オブジェクト ストア情報* を選択します。
. *クラスター* ページから、クラスターのメニュー アイコンを選択し、*オブジェクト ストア情報* を選択します。
. オブジェクト ストア情報ページで、*新しいオブジェクト ストアの作成*を選択します。
. オブジェクト ストア情報ページで、*新しいオブジェクト ストアの作成*を選択します。
+
image:screenshot_tiering_object_store_create_button.png["新しいオブジェクト ストアを作成するための [新しいオブジェクト ストアの作成] ボタンを示すスクリーンショット。"]

+
オブジェクト ストア ウィザードが起動します。以下の例は、Amazon S3 にオブジェクト ストアを作成する方法を示しています。

. *オブジェクト ストレージ名の定義*: このオブジェクト ストレージの名前を入力します。このクラスター上のアグリゲートで使用している他のオブジェクト ストレージとは一意である必要があります。
. *プロバイダーの選択*: *Amazon Web Services* などのプロバイダーを選択し、*続行* を選択します。
. *オブジェクト ストレージの作成* ページの手順を完了します。
+
.. *S3 バケット*: 新しい S3 バケットを追加するか、プレフィックス _fabric-pool_ で始まる既存の S3 バケットを選択します。次に、バケットへのアクセスを提供する AWS アカウント ID を入力し、バケットのリージョンを選択して、「続行」を選択します。
+
コンソール エージェントの IAM ポリシーにより、インスタンスがそのプレフィックスで名前が付けられたバケットに対して S3 アクションを実行できるようになるため、_fabric-pool_ プレフィックスが必要です。たとえば、S3 バケットに _fabric-pool-AFF1_ という名前を付けることができます。ここで、AFF1 はクラスターの名前です。

.. *ストレージ クラスのライフサイクル*: クラウド階層化は、階層化されたデータのライフサイクルの遷移を管理します。データは _Standard_ クラスで始まりますが、一定の日数が経過した後にデータに別のストレージ クラスを適用するルールを作成できます。
+
階層化されたデータを移行する S3 ストレージ クラスと、そのクラスにデータが割り当てられるまでの日数を選択し、[続行] を選択します。たとえば、以下のスクリーンショットは、オブジェクト ストレージで 45 日経過した後、階層化データが _Standard_ クラスから _Standard-IA_ クラスに割り当てられていることを示しています。

+
*このストレージ クラスにデータを保持する* を選択した場合、データは _Standard_ ストレージ クラスに残り、ルールは適用されません。link:reference-aws-support.html["サポートされているストレージクラスを参照"^] 。

+
image:screenshot_tiering_lifecycle_selection_aws.png["一定の日数後にデータに割り当てられる別のストレージ クラスを選択する方法を示したスクリーンショット。"]

+
ライフサイクル ルールは、選択したバケット内のすべてのオブジェクトに適用されることに注意してください。

.. *認証情報*: 必要な S3 権限を持つ IAM ユーザーのアクセスキー ID とシークレットキーを入力し、[続行] を選択します。
+
IAM ユーザーは、*S3 バケット* ページで選択または作成したバケットと同じ AWS アカウントに属している必要があります。階層化の有効化に関するセクションで必要な権限を参照してください。

.. *クラスタ ネットワーク*: ONTAP がオブジェクト ストレージに接続するために使用する IPspace を選択し、*続行* を選択します。
+
正しい IPspace を選択すると、Cloud Tiering がONTAPからクラウド プロバイダーのオブジェクト ストレージへの接続を確立できるようになります。





オブジェクト ストアが作成されます。

これで、オブジェクト ストアをクラスター内のアグリゲートに接続できるようになりました。



== ミラーリングのために2番目のオブジェクトストアをアグリゲートに接続する

2 番目のオブジェクト ストアをアグリゲートに接続してFabricPoolミラーを作成し、データを 2 つのオブジェクト ストアに同期的に階層化することができます。集約にすでに接続されているオブジェクト ストアが 1 つ必要です。 https://docs.netapp.com/us-en/ontap/fabricpool/create-mirror-task.html["FabricPoolミラーの詳細"^] 。

MetroCluster構成を使用する場合は、異なるアベイラビリティーゾーンにあるパブリック クラウド内のオブジェクト ストアを使用するのがベスト プラクティスです。 https://docs.netapp.com/us-en/ontap/fabricpool/setup-object-stores-mcc-task.html["MetroClusterの要件の詳細については、 ONTAPドキュメントをご覧ください。"^] 。  MetroCluster内では、ミラーリングされていないアグリゲートの使用は推奨されません。使用すると、エラー メッセージが表示されます。

MetroCluster構成でStorageGRID をオブジェクト ストアとして使用する場合、両方のONTAPシステムで単一のStorageGRIDシステムへのFabricPool階層化を実行できます。各ONTAPシステムは、データを異なるバケットに階層化する必要があります。

.手順
. *クラスター* ページから、選択したクラスターの *詳細設定* を選択します。
+
image:screenshot_tiering_advanced_setup_button.png["クラスターの「詳細設定」ボタンを示すスクリーンショット。"]

. 「詳細設定」ページから、使用するオブジェクト ストアをミラー オブジェクト ストアの場所にドラッグします。
+
image:screenshot_tiering_mirror_config.png["2 番目のオブジェクト ストアをアグリゲートにドラッグして階層化ミラーを作成する方法を示すスクリーンショット。"]

. [オブジェクト ストアのアタッチ] ダイアログで [*アタッチ*] を選択すると、2 番目のオブジェクト ストアが集約にアタッチされます。
+
image:screenshot_tiering_mirror_config_complete.png["集約に接続された 2 番目のオブジェクト ストアを示すスクリーンショット。"]



2 つのオブジェクト ストアが同期している間、ミラー ステータスは「同期中」と表示されます。同期が完了すると、ステータスが「同期済み」に変わります。



== プライマリオブジェクトストアとミラーオブジェクトストアを交換する

集約のプライマリ オブジェクト ストアとミラー オブジェクト ストアを交換できます。オブジェクト ストア ミラーがプライマリになり、元のプライマリがミラーになります。

.手順
. *クラスター* ページから、選択したクラスターの *詳細設定* を選択します。
+
image:screenshot_tiering_advanced_setup_button.png["クラスターの「詳細設定」ボタンを示すスクリーンショット。"]

. 「詳細設定」ページで、アグリゲートのメニュー アイコンを選択し、「*スワップ先*」を選択します。
+
image:screenshot_tiering_mirror_swap.png["アグリゲートのスワップ先オプションを示すスクリーンショット。"]

. ダイアログ ボックスでアクションを承認すると、プライマリ オブジェクト ストアとミラー オブジェクト ストアが交換されます。




== アグリゲートからミラー オブジェクト ストアを削除する

追加のオブジェクト ストアにレプリケートする必要がなくなった場合は、 FabricPoolミラーを削除できます。

.手順
. *クラスター* ページから、選択したクラスターの *詳細設定* を選択します。
+
image:screenshot_tiering_advanced_setup_button.png["クラスターの「詳細設定」ボタンを示すスクリーンショット。"]

. [詳細設定] ページで、アグリゲートのメニュー アイコンを選択し、[オブジェクト ストアのミラーリング解除] を選択します。
+
image:screenshot_tiering_mirror_delete.png["アグリゲートのオブジェクト ストアのミラーリング解除オプションを示すスクリーンショット。"]



ミラー オブジェクト ストアはアグリゲートから削除され、階層化されたデータは複製されなくなります。


NOTE: MetroCluster構成からミラー オブジェクト ストアを削除すると、プライマリ オブジェクト ストアも削除するかどうかを尋ねるプロンプトが表示されます。プライマリ オブジェクト ストアをアグリゲートに接続したままにするか、削除するかを選択できます。



== 階層化されたデータを別のクラウドプロバイダーに移行する

Cloud Tiering を使用すると、階層化されたデータを別のクラウド プロバイダーに簡単に移行できます。たとえば、Amazon S3 から Azure Blob に移行する場合は、上記の手順を次の順序で実行します。

. Azure Blob オブジェクト ストアを追加します。
. この新しいオブジェクト ストアを既存のアグリゲートのミラーとして接続します。
. プライマリ オブジェクト ストアとミラー オブジェクト ストアを交換します。
. Amazon S3 オブジェクト ストアのミラーリングを解除します。

